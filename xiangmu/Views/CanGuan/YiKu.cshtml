
@{
    ViewBag.Title = "YiKu";
    Layout = "~/Views/mubanye/ym.cshtml";
}
<style>
    .black_overlay {
        display: none;
        position: absolute;
        top: 0%;
        left: 0%;
        width: 100%;
        height: 150%;
        background-color: black;
        z-index: 1001;
        opacity: .80;
        filter: alpha(opacity=88);
    }

    .white_content {
        display: none;
        position: absolute;
        top: 25%;
        left: 15%;
        width: 60%;
        height: 75%;
        padding: 20px;
        background-color: white;
        z-index: 1002;
        overflow: auto;
    }
</style>


<head>
    <link href="~/images/iconfont/iconfont.css" rel="stylesheet" />
</head>
<body class="fixed-top" style="width:1600px;margin-left:290px">

    <div id="header" class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container-fluid">
                <a class="brand" href="javascript:void(0)" style="width: 180px; color: white;">仓储管理系统</a>
                <a class="btn btn-navbar collapsed" id="main_menu_trigger" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="arrow"></span>
                </a>

            </div>
        </div>
    </div>

    <div id="container" class="row-fluid ">

        <div id="sidebar" class="nav-collapse collapse">
            <div class="sidebar-toggler hidden-phone"></div>
            <ul>

                <li class="has-sub "><a href="javascript:void(0);"><i class="icon-bookmark-empty"></i><span class="title">系统设置</span><span class="arrow "></span></a><ul class="sub"><li><a href="/Home/UserList">员工管理</a></li><li><a href="/Home/RoleList">角色管理</a></li><li><a href="/Home/DepartList">部门管理</a></li><li><a href="/Res/Index">菜单管理</a></li><li><a href="/Res/Power">权限分配</a></li><li><a href="/Home/SN">标识符管理</a></li></ul></li>
                <li class="has-sub "><a href="javascript:void(0);"><i class="icon-bookmark-empty"></i><span class="title">基本资料</span><span class="arrow "></span></a><ul class="sub"><li><a href="/Storage/Location/List">库位管理</a></li><li><a href="/Client/Supplier/Index">供应商管理</a></li><li><a href="/Client/Customer/Index">客户管理</a></li><li><a href="/Storage/Measure/Index">计量单位</a></li><li><a href="/Product/Goods/List">产品类别</a></li><li><a href="/Product/Goods/Index">产品管理</a></li></ul></li>
                <li class="has-sub active"><a href="javascript:void(0);"><i class="icon-bookmark-empty"></i><span class="title">仓库作业</span><span class="arrow open"></span></a><ul class="sub"><li><a href="/InStorage/Product/List">入库管理</a></li><li><a href="/OutStorage/Product/List">出库管理</a></li><li><a href="/Bad/Product/List">报损管理</a></li><li class="active"><a href="/Move/Product/List">移库管理</a></li><li><a href="/Check/Product/List">盘点管理</a></li><li><a href="/Returns/Product/List">退货管理</a></li></ul></li>
                <li class="has-sub "><a href="javascript:void(0);"><i class="icon-bookmark-empty"></i><span class="title">报表管理</span><span class="arrow "></span></a><ul class="sub"><li><a href="/Report/Report/StockBillReport">库存清单</a></li><li><a href="/Report/Report/ProductReport">货品统计</a></li><li><a href="/Report/Report/ProductInOutReport">出入库报表</a></li><li><a href="/Report/Report/InStorageReport">入库报表</a></li><li><a href="/Report/Report/OutStorageReport">出库报表</a></li><li><a href="/Report/Report/BadReport">报损报表</a></li><li><a href="/Report/Report/ReturnReport">退货报表</a></li><li><a href="/Report/Report/CustomerReport">客户报表</a></li><li><a href="/Report/Report/SupplierReport">供应商报表</a></li><li><a href="/Report/Report/InventoryReport">台账记录</a></li><li><a href="/Report/Manager/List">自定义报表</a></li></ul></li>
                <li class="">
                    <a href="/Home/LoginOut">
                        <i class="icon-user"></i>
                        <span class="title">退出系统</span>
                    </a>
                </li>

            </ul>
        </div>

        <div id="body">
            <div id="widget-config" class="modal hide">
                <div class="modal-header">
                    <button data-dismiss="modal" class="close" type="button"></button>
                    <h3>widget Settings</h3>
                </div>
                <div class="modal-body">
                    <p>Here will be a configuration form</p>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span12">
                        <ul class="breadcrumb"><li><i class="icon-home"></i><a href="/Home/Welcome">首页</a><i class="icon-angle-right"></i></li><li><a href="javascript:void(0)">仓库作业</a><i class="icon-angle-right"></i></li><li><a href="javascript:void(0)">移库管理</a></li></ul>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span12">
                        <div class="widget box light-grey">
                            <div class="widget-title">
                                <h4><i class="icon-globe"></i>移库管理</h4>
                                <div class="tools">
                                    <a href="javascript:void(0);" class="collapse"></a>
                                    <a href="#widget-config" data-toggle="modal" class="config"></a>
                                    <a href="javascript:void(0);" class="reload"></a>
                                    <a href="javascript:void(0);" class="remove"></a>
                                </div>
                            </div>
                            <div class="widget-body">
                                <div class="clearfix margin-bottom-10">
                                    <div class="btn-group" id="btnStatusGroup">
                                        <button class="btn" value="0" id="auditname" name="auditname">所有</button>
                                        <button class="btn" value="1" id="btna" type="submit" name="auditname">待审核</button>
                                        <button class="btn" value="2" id="btnb" type="submit" name="auditname">审核通过</button>
                                        <button class="btn" value="3" id="btnc" type="submit" name="auditname">审核失败</button>
                                    </div>
                                    <div class="actions  pull-right">
                                        <a class="btn btn-primary" href="@Url.Action("YiKuinsert")"><i class="icon-pencil"></i>&nbsp;新增</a>
                                        <button type="button" class="btn btn-danger" id="scan">删除</button>
                                        <a class="btn btn-info" href="javascript:void(0)" onclick="ProductMoveManager.ToExcel()"><i class="icon-download"></i>&nbsp;导出</a>
                                    </div>
                                </div>

                                <div class="row-fluid">
                                    <form class="form-horizontal" action="javascript:void(0)">
                                        <div class="control-group">
                                            <div class="controls controls-cus" style="margin-top:20px;">
                                                <div class="row">
                                                    <input id="YiKuDanHao" name="YiKuDanHao" type="text" class="input-medium" style="height:38px; margin-left:15px;" placeholder="请输入移库单号" />&nbsp;&nbsp;
                                                    时间
                                                    <input id="Stratdate" value="@DateTime.Now.AddDays(-7).ToString("yyyy-MM-dd")" style="width:300px" type="date" name="Stratdate" class="form-control" />到<input id="Enddate" value="@DateTime.Now.AddDays(1).ToString("yyyy-MM-dd")" type="date" style="width:300px" name="Enddate" class="form-control" />
                                                    <button id="btncx" class="col-md-1 btn btn-primary" style="margin-top:0px;margin-left:80px; width:60px;" type="submit">查询</button>

                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>

                                <table class="table table-striped table-bordered table-hover" id="tabInfo" style="margin-top:20px;">
                                    <thead>
                                        <tr class="widget-title">
                                            <th><input id="qxname" name="qxname" type="checkbox" class="group-checkable" /></th>
                                            <th class="hidden-480">移库单编号</th>
                                            <th class="hidden-480">移库类型</th>
                                            <th class="hidden-480">关联单号</th>
                                            <th class="hidden-480">移库总数</th>
                                            <th class="hidden-480">移库人</th>
                                            <th class="hidden-480">状态</th>
                                            <th class="hidden-480">创建时间</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @*<tr>
                                                <th>1</th>
                                                <th>1</th>
                                                <th>1</th>
                                                <th>1</th>
                                                <th>1</th>
                                                <th>1</th>
                                                <th>1</th>
                                                <th>1</th>

                                                <th>
                                                    <a class="icon-edit" href="/Move/Product/Edit?orderNum=000001" id="bianji" title="编辑"><span class="iconfont">&#xe612;</span></a>&nbsp;&nbsp;&nbsp;
                                                    <a class="icon-remove" href="javascript:void(0)" title="删除"><span class="iconfont">&#xe686;</span></a>&nbsp;&nbsp;&nbsp;
                                                    <a class="icon-remove" href="javascript:void(0)" title="查看"><span class="iconfont">&#xe601;</span></a>&nbsp;&nbsp;&nbsp;
                                                    <a class="icon-remove" href="javascript:void(0)" title="审核"><span class="iconfont">&#xe676;</span></a>
                                                </th>
                                            </tr>*@
                                    </tbody>
                                </table>
                                <div class="form-inline form-group">
                                    <button id="btnsy" class="btn btn-info form-group">首页</button>
                                    <button id="btsyy" class="btn btn-info form-group">上一页</button>
                                    <input type="text" id="txtpageIndex" class="form-control" style="width:110px;" />
                                    <button id="btGo" class="btn btn-info form-group">Go</button>
                                    <button id="btnxyy" class="btn btn-info form-group">下一页</button>
                                    <button id="btnwy" class="btn btn-info form-group">尾页</button>
                                    <label id="txtLabel" style="font-size:16px;margin:0px auto;"></label>
                                </div>
                                <div class="row-fluid" id="mypager">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @*///弹出框*@
    <div>
        @*style="margin-top:240px;margin-left:730px;"*@
        <button type="button" class="btn btn-primary" style="margin-top:30px;" href="javascript:void(0)" onclick="document.getElementById('light').style.display='block';document.getElementById('fade').style.display='block'">
            确定
        </button>
    </div>
    <div id="light" class="white_content">
        <div>
            <form class="form-inline">
                <div class="form-group mb-3">
                    <label>出库单号</label>
                </div>
                <div class="form-group mx-sm-3 mb-2">
                    <input type="text" class="form-control" id="inputPassword2">
                </div>
                <div class="form-group mb-3">
                    <label>类型</label>
                </div>

                <div class="form-group mx-sm-3 mb-2">
                    <input type="text" class="form-control" id="inputPassword2">
                </div>
                <div class="form-group mb-3">
                    <label>状态</label>
                </div>
                <div class="form-group mx-sm-3 mb-2">
                    <input type="text" class="form-control" id="inputPassword2">
                </div>
                <div class="form-group mb-3">
                    <label>客户编号</label>
                </div>
                <div class="form-group mx-sm-3 mb-2">
                    <input type="text" class="form-control" id="inputPassword2">
                </div>
                <div class="form-group mb-3">
                    <label>客户名称</label>
                </div>
                <div class="form-group mx-sm-3 mb-2">
                    <input type="text" class="form-control" id="inputPassword2">
                </div>
                <div class="form-group mb-3">
                    <label>联系人</label>
                </div>
                <div class="form-group mx-sm-3 mb-2">
                    <input type="text" class="form-control" id="inputPassword2">
                </div>
                <div class="form-group mb-3">
                    <label>关联单号</label>
                </div>
                <div class="form-group mx-sm-3 mb-2">
                    <input type="text" class="form-control" id="inputPassword2">
                </div>
                <div class="form-group mb-3">
                    <label>创建人</label>
                </div>
                <div class="form-group mx-sm-3 mb-2">
                    <input type="text" class="form-control" id="inputPassword2">
                </div>
                <div class="form-group mb-3">
                    <label>创建时间</label>
                </div>
                <div class="form-group mx-sm-3 mb-2">
                    <input type="text" class="form-control" id="inputPassword2">
                </div>
                <div class="form-group mb-3">
                    <label>电话</label>
                </div>
                <div class="form-group mx-sm-3 mb-2">
                    <input type="text" class="form-control" id="inputPassword2">
                </div>
                <div class="form-group mb-3">
                    <label>地址</label>
                </div>
                <div class="form-group mx-sm-3 mb-2">
                    <input type="text" class="form-control" id="inputPassword2">
                </div>
                @*<button type="submit" class="btn btn-primary mb-2">
                        搜索
                    </button>*@
                &nbsp;&nbsp;

            </form>
            <hr />
            <hr />
            <div style="width:1000px;">
                <table class="table table-striped table-bordered table-hover" id="tabInfo">
                    <thead>
                        <tr class="widget-title">
                            <th style="width: 8px;"><input type="checkbox" class="group-checkable" onclick="InStorageManager.SelectAll(this)" /></th>
                            <th class="hidden-480">产品名称</th>
                            <th class="hidden-480">产品条码</th>
                            <th class="hidden-480">产品编号</th>
                            <th class="hidden-480">批次</th>
                            <th class="hidden-480">当前库位</th>
                            <th class="hidden-480">现有库存</th>
                            <th class="hidden-400">移库数量</th>
                            <th class="hidden-400">移入库位</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th style="width: 8px;"><input type="checkbox" class="group-checkable" onclick="InStorageManager.SelectAll(this)" /></th>
                            <th>1</th>
                            <th>1</th>
                            <th>1</th>
                            <th>1</th>
                            <th>1</th>
                            <th>1</th>
                            <th> <input type="text" class="form-control" id="inputPassword2" style="width:120px;height:30px;"></th>
                            <th> <input type="text" class="form-control" id="inputPassword2" style="width:120px;height:30px;"></th>

                        </tr>
                    </tbody>
                </table>

                <div style="">
                    <button type="button" class="btn btn-secondary" style="margin-top:10px;" href="javascript:void(0)" onclick="document.getElementById('light').style.display='none';document.getElementById('fade').style.display='none'">审核通过</button>
                    <button type="button" class="btn btn-secondary" style="margin-top:10px;" href="javascript:void(0)" onclick="document.getElementById('light').style.display='none';document.getElementById('fade').style.display='none'">审核不通过</button>
                    <button type="button" class="btn btn-secondary" style="margin-top:10px;" href="javascript:void(0)" onclick="document.getElementById('light').style.display='none';document.getElementById('fade').style.display='none'">关闭</button>
                </div>
            </div>
        </div>
    </div>
    <div id="fade" class="black_overlay"></div>
    @*///弹出框*@
    <div id="container" class="row-fluid "></div>
    <div id="footer">



        <div class="span pull-right">
            <span class="go-top"><i class="icon-arrow-up"></i></span>
        </div>
    </div>
</body>
<script type="text/javascript" src="/Theme/plugins/jquery-1.8.3.min.js?t=c337c6ed-2820-4e2d-89e0-e55aca2bea08"></script>
<script type="text/javascript" src="/Theme/plugins/bootstrap/js/bootstrap.min.js?t=c1612750-af1c-4060-a11e-3de79421cb2d"></script>
<script type="text/javascript" src="/Theme/plugins/jbox-v2.3/jBox/jquery.jBox-2.3.min.js?t=7285d83b-f8a2-46a6-aab8-6046b39225e2"></script>
<script type="text/javascript" src="/Common/Js?t=be75ad47-da19-419a-b28b-094546a7efea"></script>
<script type="text/javascript" src="/Theme/plugins/My97DatePicker/WdatePicker.js?t=df4f955d-a089-4cd2-82c5-37410546a423"></script>
<script type="text/javascript" src="/Theme/plugins/jquery-autocomplete3.2.2/jquery.autocomplete.js?t=4d3349e2-124c-424a-b0f9-16c7dd671869"></script>
<script type="text/javascript" src="/Theme/customer/Git.Framework.Common.js?t=f6f5b32e-0e24-40a3-93ed-9d7a69e40192"></script>
<script type="text/javascript" src="/Theme/customer/Git.Framework.UICommon.js?t=88c21656-fa07-416f-97eb-7f9a13b7c970"></script>
<script type="text/javascript" src="/Theme/customer/Move/Git.Storage.MoveOrder.js?t=e8390bcf-e127-4d99-9a8d-c47b73882e6a"></script>

<script type="text/javascript">
    var aner = 0;
      var pageIndexvalue = 1;
        $(function () {
            //审核
            $("#btnStatusGroup .btn").click(function () {
                var sh = $(this).val();
                aner = sh
                bingdate(sh);
            });

            $("#btnsy").click(function () {
                pageIndexvalue = 1;
                bingdate();
            })
            $("#btsyy").click(function () {
                pageIndexvalue = pageIndexvalue - 1;
                bingdate();
            })
            $("#btGo").click(function () {
                pageIndexvalue = parseInt($("#txtpageIndex").val());
                bingdate();
            })
            $("#btnxyy").click(function () {
                pageIndexvalue = pageIndexvalue + 1;
                bingdate();
            })
            $("#btnwy").click(function () {
                pageIndexvalue = 999999;
                bingdate();
            })
            //删除按钮
            $("#scan").click(function () {
                BindDelete();
            });  //删除
            function BindDelete() {

                var CLength = $("[name=fxkname]:checked").length;
                if (CLength == 1) {
                    var CIdValueDelete = $("[name=fxkname]:checked").parent().next().text();
                    if (confirm("确定删除出库单号为【" + CIdValueDelete + "】的数据吗？")) {
                        $("[name=fxkname]:checked").parent().parent().find("td").remove();
                    }
                } else if (CLength > 1) {
                    var CheckedLength = $("[name=fxkname]:checked").length;
                    if (confirm("确定删除这【" + CheckedLength + "】项？")) {
                        $("[name=fxkname]:checked").parent().parent().find("td").remove();
                    }
                } else if (CLength < 1) {
                    alert("请选择要删除项！");
                }

            }

            $("#btncx").click(function () {
                bingdate(aner);
            });
            $("#btngjcx").click(function () {
                bingdate(aner);
            });

            bingdate(aner);
        })

    function bingdate(aand) {
            var namevalue = $("[name=YiKuDanHao ]").val();
            var Stratdatevalue = $("[name=Stratdate]").val();
            var Enddatevalue = $("[name=Enddate]").val();

            $.ajax({
                url: "@Url.Action("YiKuCha")",
                data: { YiKuDanHao: namevalue, Stratdate: Stratdatevalue, Enddate: Enddatevalue, pageIndex: pageIndexvalue, aid: aand },
                dataType: "json",
                type: "get",
                success: function (fwResult) {
                    $("#txtLabel").html("当前第" + fwResult.PageIndex + " 页 / 共计" + fwResult.Count + " 页 共计" + fwResult.PageCount + " 条");

                    $("#txtpageIndex").val(fwResult.PageIndex);

                    pageIndexvalue = fwResult.PageIndex;

                    $("table tr:gt(0)").remove();
                    $.each(fwResult.fwaction,function(index,value)  {
                        var str = "<tr>";
                        str += "<td><input name=\"fxkname\" type=\"checkbox\" class=\"group-checkable\" /></td>";
                        str += "<td>" + value.mid+ "</td>";
                        str += "<td>" + value.movetypename + "</td>";
                        str += "<td>" + value.ykname + "</td>";
                        str += "<td>" + value.count + "</td>";
                        str += "<td>" + value.moveperson + "</td>";
                        str += "<td>" + value.auditname + "</td>";
                        str += "<td>" + value.AddTime + "</td>";

                        str += "<td><button type='button' onclick='Del(" + value.mid + ")'>删除</button><a href='/CanGuan/YKupdateCha/" + value.mid + "'>修改</a></td>";
                        str += "</tr>";
                        $("table tbody").append(str);
                        
                            //<a href='/CanGuan/DelInStorage/" + value.mid +"'>删除</a>
                    })
                }

            })
        }
    function Del(id) {
        if (confirm('是否删除?')) {
            $.ajax({
                type: "POST",
                url: "/CanGuan/DelInStorage",
                data: "{Id:'" + id + "'}",
                dataType: "json",
                contentType: "application/json",
                success: function (result) {
                    if (result > 0) {
                        alert("删除成功");
                        bingdate(aner);
                    }
                    else {
                        alert("删除失败");
                    }
                },
                error: function (ex) {
                    alert(ex.responseText);
                }
                ,
            });
        }
    }
</script>

@*<script type="text/javascript">

        $(document).ready(function () {
            $("#btnUpdate").click(BingUpdate);
        })

        function BingUpdate () {
            var formvalue = $("form").serializeArray();
            var objjson = {};
            $.each(formvalue, function(index,value) {
                objjson[value.name] = value.value;
            })
            $.ajax({
                url: "@Url.Action("YKDelete")",
                data: objjson,
                dataType: "json",
                type: "get",
                success: function (UpdateResult) {
                    alert(UpdateResult.Msg);
                }
            })
        }

</script>*@